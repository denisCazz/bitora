---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import '../styles/global.css';

export interface Props {
  title: string;
  description?: string;
}

const { title, description } = Astro.props;
const canonicalUrl = Astro.site ? new URL(Astro.url.pathname, Astro.site).toString() : undefined;
---

<!doctype html>
<html lang="it">
  <head>
    <!-- Analytics -->
    <script
      defer
      src="https://cloud.umami.is/script.js"
      data-website-id="2adbf0f8-a9d3-47bd-9a32-61ac932f9640"></script>

    <!-- Essential Meta -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <!-- SEO -->
    <title>{title}</title>
    <meta
      name="description"
      content={description ??
        'Siti web minimalisti e professionali per aziende e freelance. Bitora crea soluzioni digitali rapide, eleganti e su misura per il tuo business.'}
    />
    {canonicalUrl && <link rel="canonical" href={canonicalUrl} />}

    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/bitora.png" />

    <!-- Fonts with optimized loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      /></noscript
    >

    <!-- Sitemap -->
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://bitora.it/" />
    <meta property="og:title" content={title} />
    <meta
      property="og:description"
      content={description ??
        'Siti web minimalisti, professionali e veloci. Bitora realizza soluzioni digitali su misura per aziende e professionisti che vogliono distinguersi online.'}
    />
    <meta property="og:image" content="https://bitora.it/bitora.jpg" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://bitora.it/" />
    <meta name="twitter:title" content={title} />
    <meta
      name="twitter:description"
      content={description ??
        'Siti web minimalisti, professionali e veloci. Bitora realizza soluzioni digitali su misura per aziende e professionisti che vogliono distinguersi online.'}
    />
    <meta name="twitter:image" content="https://bitora.it/bitora.jpg" />

    <!-- Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Bitora",
        "url": "https://bitora.it",
        "logo": "https://bitora.it/bitora.png",
        "sameAs": [
          "https://www.instagram.com/bitorait/",
          "https://www.facebook.com/people/Bitora-Italia/pfbid0JubiVqBfxyM2nY6CoHLW3P5vQkjhUGE5UF5Pa16f491fzGsneW512MdMTiEpgvJCl/?mibextid=wwXIfr&rdid=xyslEd78VfiU5dPK&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1BTziLdEef%2F%3Fmibextid%3DwwXIfr"
        ]
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "url": "https://bitora.it/",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://bitora.it/?s={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>
  </head>
  <body class="flex flex-col min-h-screen font-['Inter',sans-serif] bg-white text-gray-900">
    <a href="#main-content" class="skip-link">Salta al contenuto principale</a>
    <Header />
    <main id="main-content" class="flex-grow" tabindex="-1">
      <slot />
    </main>
    <Footer />
    
    <!-- Back to Top Button -->
    <button 
      id="back-to-top" 
      class="fixed bottom-6 right-6 z-50 bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg transition-all duration-300 opacity-0 invisible hover:scale-110 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
      aria-label="Torna in cima"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
      </svg>
    </button>

    <script>
      // Back to Top functionality
      const backToTopButton = document.getElementById('back-to-top');
      
      if (backToTopButton) {
        // Show/hide button based on scroll position
        function toggleBackToTop() {
          if (window.scrollY > 300) {
            backToTopButton.classList.remove('opacity-0', 'invisible');
            backToTopButton.classList.add('opacity-100', 'visible');
          } else {
            backToTopButton.classList.add('opacity-0', 'invisible');
            backToTopButton.classList.remove('opacity-100', 'visible');
          }
        }
        
        // Smooth scroll to top
        function scrollToTop() {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        }
        
        // Add event listeners
        window.addEventListener('scroll', toggleBackToTop);
        backToTopButton.addEventListener('click', scrollToTop);
        
        // Initial check
        toggleBackToTop();
      }
    </script>
  </body>
</html>
